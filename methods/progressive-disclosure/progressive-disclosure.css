/* ===========================================
   Progressive Disclosure Method
   Click-to-reveal content sections
   =========================================== */

/* ---------- Reveal Sections ---------- */
.reveal-section {
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    transform: translateY(20px);
    transition:
        opacity var(--transition-slow),
        transform var(--transition-slow),
        max-height var(--transition-slow);
    margin-bottom: 0;
}

.reveal-section.active {
    opacity: 1;
    max-height: 2000px;
    /* Large enough to contain content */
    transform: translateY(0);
    margin-bottom: var(--space-lg);
}

/* First section should be visible by default */
.reveal-section:first-of-type {
    opacity: 1;
    max-height: 2000px;
    transform: translateY(0);
    margin-bottom: var(--space-lg);
}

/* ---------- Content Cards in Sections ---------- */
.reveal-section .section-content {
    background-color: rgba(18, 18, 26, 0.85);
    /* Semi-transparent for background visibility */
    backdrop-filter: blur(4px);
    /* Glassmorphism */
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius-lg);
    padding: var(--space-lg);
}

.reveal-section h2 {
    color: var(--color-text-primary);
    margin-bottom: var(--space-md);
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.reveal-section h2::before {
    display: inline-block;
    width: 4px;
    height: 24px;
    background: linear-gradient(180deg, var(--color-accent), var(--color-accent-hover));
    border-radius: 2px;
}

/* ---------- Reveal Trigger Button ---------- */
.reveal-trigger {
    display: flex;
    width: fit-content;
    margin: var(--space-lg) auto 0 auto;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-md) var(--space-lg);
    background-color: var(--color-accent);
    color: white;
    font-family: inherit;
    font-size: var(--font-size-base);
    font-weight: 500;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: all var(--transition-fast);
    box-shadow: 0 0 20px var(--color-accent-glow);
}

.reveal-trigger:hover {
    background-color: var(--color-accent-hover);
    transform: translateY(-2px);
    box-shadow: 0 4px 24px var(--color-accent-glow);
}

.reveal-trigger:active {
    transform: translateY(0);
}

/* Arrow icon */
.reveal-trigger::after {
    content: 'â†’';
    font-size: 1.1em;
    transition: transform var(--transition-fast);
}

.reveal-trigger:hover::after {
    transform: translateX(4px);
}

/* Hide trigger once section is revealed (next section handles continue) */
.reveal-section.revealed .reveal-trigger {
    display: none;
}

/* Allow fully revealed sections to take natural height */
.reveal-section.revealed {
    max-height: none;
    overflow: visible;
}

/* ---------- Completion Section ---------- */
.lesson-complete {
    text-align: center;
    padding: var(--space-2xl) var(--space-lg);
}

.lesson-complete h2 {
    justify-content: center;
}

.lesson-complete h2::before {
    display: none;
}

.complete-lesson-btn {
    padding: var(--space-lg) var(--space-2xl);
    font-size: var(--font-size-lg);
}

/* Completion celebration state */
.lesson-complete.celebrating {
    animation: celebrate 0.6s ease;
}

@keyframes celebrate {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.02);
    }
}

/* ---------- Step Counter (Removed by User Request) ---------- */
.step-counter {
    display: none;
}

.step-counter .current {
    color: var(--color-accent);
    font-weight: 600;
}

/* ---------- Custom Scrollbar for Progressive Disclosure ---------- */
/* Using .cyberdeck-main as the scroll container since it holds the lesson content */
.cyberdeck-main::-webkit-scrollbar {
    width: 10px;
    background: var(--color-bg);
}

.cyberdeck-main::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.02);
    border-radius: 4px;
    border: 1px solid var(--color-border);
}

.cyberdeck-main::-webkit-scrollbar-thumb {
    background: var(--color-accent);
    border-radius: 4px;
    border: 2px solid var(--color-bg);
    /* Padding effect */
    box-shadow: 0 0 10px var(--color-accent-glow);
}

.cyberdeck-main::-webkit-scrollbar-thumb:hover {
    background: var(--color-accent-hover);
    box-shadow: 0 0 15px var(--color-accent);
}

/* Ensure the step counter stays distinct */
.step-counter .current {
    color: var(--color-accent);
    font-weight: 600;
}

/* ===========================================
   Progressive Disclosure Layouts 
   (Left/Right/Full Image Support)
   Note: Top/Bottom layouts deprecated by design choice.
   =========================================== */

/* Inner Flex Wrapper (lives inside .section-content) */
.pd-flex-wrapper {
    display: flex;
    gap: var(--space-lg);
    align-items: center;
    /* Centered as requested */
    width: 100%;
}

/* Container for Image/Video */
.pd-media-container {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid var(--color-border-dim);
    border-radius: var(--border-radius);
    padding: var(--space-sm);
    /* User Request: A little padding */
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    height: fit-content;
}

.pd-media-container img,
.pd-media-container video {
    width: 100%;
    height: auto;
    object-fit: contain;
    display: block;
    border-radius: 4px;
}

/* Text Content Area */
.pd-text-content {
    flex: 1;
    min-width: 0;
    /* Prevent flex overflow */
}

/* --- Layout: Text Only (Center Aligned) --- */
/* When no layout class is present or explicitly no-media */
.reveal-section:not(:has(.pd-media-container)) .pd-text-content,
.pd-layout-none .pd-text-content {
    text-align: center;
    max-width: 800px;
    /* Constrain width for readability & side interaction */
    margin: 0 auto;
    padding: 0 var(--space-xl);
    /* Extra padding */
}

/* --- Layout: Left --- */
/* Image takes 30%, Content takes 70% */
.pd-layout-left .pd-flex-wrapper {
    flex-direction: row;
}

.pd-layout-left .pd-media-container {
    width: 30%;
    flex-shrink: 0;
}

/* --- Layout: Right --- */
/* Image takes 30% (on right), Content takes 70% */
.pd-layout-right .pd-flex-wrapper {
    flex-direction: row-reverse;
}

.pd-layout-right .pd-media-container {
    width: 30%;
    flex-shrink: 0;
}

/* --- Layout: Full (Single Image) --- */
/* If no content, media takes full width */
.pd-layout-full .pd-flex-wrapper {
    flex-direction: column;
}

.pd-layout-full .pd-media-container {
    width: 100%;
    margin-bottom: var(--space-sm);
}

.pd-layout-full .pd-text-content {
    width: 100%;
}

/* --- Responsive Optimization (Mobile/Tablet < 900px) --- */
@media (max-width: 900px) {

    /* Force vertical stacking for ALL layouts */
    .pd-layout-left .pd-flex-wrapper,
    .pd-layout-right .pd-flex-wrapper {
        flex-direction: column;
        gap: var(--space-md);
    }

    /* Reset widths to full */
    .pd-layout-left .pd-media-container,
    .pd-layout-right .pd-media-container,
    .pd-media-container {
        width: 100%;
        margin-bottom: var(--space-sm);
    }

    .pd-text-content {
        width: 100%;
    }

    /* Optimize Padding for smaller screens */
    .reveal-section .section-content {
        padding: var(--space-md);
    }
}